# Guided exercise: Kubernetes Cluster status

## Check nodes

Check information about the cluster that is provided to you.

Display basic information about nodes in the cluster:
```
[root@think ~]# kubectl get node -o wide
NAME        STATUS   ROLES    AGE    VERSION   INTERNAL-IP   EXTERNAL-IP   OS-IMAGE    KERNEL-VERSION                CONTAINER-RUNTIME
think.ibm   Ready    master   313d   v1.23.3   10.0.0.10     <none>        OpenStack   3.10.0-1160.53.1.el7.x86_64   docker://20.10.12
```

Check thoroughly information about that node:
```
[root@think ~]# kubectl get node think.ibm -o yaml | less
```

Review the provided information.

Answer the following questions:
* What labels are applied to this node?
* What is the IP address range that is assigned to the PODs?
* How much CPU and Memory is available?

## Check pods

Display basic information about pods running in the cluster:
```
[root@think ~]# kubectl get pod -A
NAMESPACE      NAME                                                              READY   STATUS      RESTARTS   AGE
apiconnect     analytics-cj-retention-1647480600-kkjcr                           0/1     Completed   0          5h9m
apiconnect     analytics-cj-rollover-1647497700-9r428                            0/1     Completed   0          24m
apiconnect     analytics-client-59657bffc9-426pz                                 1/1     Running     0          20h
apiconnect     analytics-ingestion-774cfd8954-rjfl7                              1/1     Running     0          20h
apiconnect     analytics-mtls-gw-79dbfbd767-76gbm                                1/1     Running     0          20h
apiconnect     analytics-storage-coord-68f645bbd6-rbxbt                          1/1     Running     0          20h
apiconnect     analytics-storage-data-0                                          1/1     Running     0          20h
apiconnect     analytics-storage-master-0                                        1/1     Running     0          20h
apiconnect     backrest-backup-management-93aee87d-postgres-4pnsb                0/1     Completed   0          21h
apiconnect     datapower-operator-84cbd7fb5-r5mgb                                1/1     Running     0          22h
apiconnect     datapower-operator-conversion-webhook-754dc54db8-wkz75            1/1     Running     0          22h
apiconnect     gwv6-0                                                            1/1     Running     0          20h
apiconnect     hostpath-provisioner-5dc69c8d77-hsrmz                             1/1     Running     6          314d
apiconnect     ibm-apiconnect-566c6f9795-9w7kp                                   1/1     Running     0          21h
apiconnect     management-93aee87d-postgres-backrest-shared-repo-5cf9d7d4lw2fr   1/1     Running     0          21h
apiconnect     management-93aee87d-postgres-c478b4d66-rgsjg                      1/1     Running     0          21h
apiconnect     management-93aee87d-postgres-full-sch-backup-stww7                0/1     Completed   0          5h39m
apiconnect     management-93aee87d-postgres-pgbouncer-59d5d9b578-8s7tz           1/1     Running     0          21h
apiconnect     management-analytics-proxy-7f456bc847-vgcv6                       1/1     Running     0          21h
apiconnect     management-apim-5f457b876b-km59v                                  1/1     Running     0          21h
apiconnect     management-apim-restore-22d22df2-g8sdw                            0/1     Completed   0          5d14h
apiconnect     management-apim-restore-c3861989-7sdt7                            0/1     Completed   0          5d15h
apiconnect     management-client-downloads-server-58958d6949-ccrxb               1/1     Running     0          21h
apiconnect     management-juhu-7ddf6c95c9-5bs44                                  1/1     Running     6          21h
apiconnect     management-ldap-65d4cdb75d-x5tvw                                  1/1     Running     0          21h
apiconnect     management-lur-5c9db677bc-lzn4s                                   1/1     Running     0          21h
apiconnect     management-nats-operator-7f457f776d-4mq59                         1/1     Running     0          21h
apiconnect     management-nats-streaming-operator-58b7588cd8-ng52k               1/1     Running     0          21h
apiconnect     management-natscluster-1                                          1/1     Running     0          21h
apiconnect     management-portal-proxy-7bf87ccc58-2ldph                          1/1     Running     0          21h
apiconnect     management-stancluster-1                                          1/1     Running     0          21h
apiconnect     management-taskmanager-6cf655676d-c9mj9                           1/1     Running     0          21h
apiconnect     management-ui-56c898b585-p9j5v                                    1/1     Running     0          21h
apiconnect     management-up-apim-data-populate-0-to-14-26303385-82gt8           0/1     Completed   0          5d15h
apiconnect     management-up-apim-data-populate-14-to-135-c01ef33e-554c4         0/1     Completed   0          21h
apiconnect     management-up-apim-schema-0-to-14-26303385-hqjrm                  0/1     Completed   0          5d15h
apiconnect     management-up-apim-schema-14-to-135-c01ef33e-cthl6                0/1     Completed   0          21h
apiconnect     management-up-lur-data-populate-0-to-3-26303385-qllbn             0/1     Completed   0          5d15h
apiconnect     management-up-lur-schema-0-to-3-26303385-wd9t8                    0/1     Completed   0          5d15h
apiconnect     management-websocket-proxy-568c994c9f-5gtwd                       1/1     Running     0          21h
apiconnect     portal-a51ccbf8-db-0                                              2/2     Running     0          20h
apiconnect     portal-a51ccbf8-www-0                                             2/2     Running     0          20h
apiconnect     portal-nginx-0                                                    1/1     Running     0          20h
apiconnect     postgres-operator-84755f7b4b-l5g4s                                4/4     Running     0          21h
apiconnect     tiller-deploy-6bfffc8ff-tnx2l                                     1/1     Running     6          314d
cert-manager   cert-manager-844897667d-gcgnm                                     1/1     Running     6          314d
cert-manager   cert-manager-cainjector-f7b995c-7fwvl                             1/1     Running     8          314d
cert-manager   cert-manager-webhook-69bd675cb-dwv7s                              1/1     Running     6          314d
default        mailhog-755989dd78-fwt2m                                          1/1     Running     0          7d16h
kube-system    calico-kube-controllers-b96cdbbbf-46nrw                           1/1     Running     6          314d
kube-system    calico-node-r5mgg                                                 1/1     Running     7          314d
kube-system    coredns-f9fd979d6-qm548                                           1/1     Running     0          21h
kube-system    coredns-f9fd979d6-sphvz                                           1/1     Running     0          21h
kube-system    etcd-think.ibm                                                    1/1     Running     0          21h
kube-system    ingress-nginx-ingress-controller-pk4bc                            1/1     Running     6          314d
kube-system    ingress-nginx-ingress-default-backend-77d64745d9-g495q            1/1     Running     6          314d
kube-system    kube-apiserver-think.ibm                                          1/1     Running     0          21h
kube-system    kube-controller-manager-think.ibm                                 1/1     Running     0          21h
kube-system    kube-proxy-pznfz                                                  1/1     Running     0          21h
kube-system    kube-scheduler-think.ibm                                          1/1     Running     0          21h
```

Review additional information about the pods in cert-manager namespace:
```
[root@think ~]# kubectl -n cert-manager get pod -o wide
NAME                                    READY   STATUS    RESTARTS   AGE    IP               NODE        NOMINATED NODE   READINESS GATES
cert-manager-844897667d-gcgnm           1/1     Running   6          314d   192.168.145.19   think.ibm   <none>           <none>
cert-manager-cainjector-f7b995c-7fwvl   1/1     Running   8          314d   192.168.145.33   think.ibm   <none>           <none>
cert-manager-webhook-69bd675cb-dwv7s    1/1     Running   6          314d   192.168.145.8    think.ibm   <none>           <none>
```

Check details of `cert-manager-844897667d-gcgnm` pod:
```
[root@think ~]# kubectl -n cert-manager get pod cert-manager-844897667d-gcgnm -o yaml | less
```

Answer the following questions:
* What image is running in the pod?
* What are the arguments that are provided to the container runtime?
* What are the environment variables that are being passed on to the container runtime?
* What are the volumes that are mounted to the container?

## Check deployments

Display information about deployments in the cluster:
```
[root@think ~]# kubectl get deploy -A
NAMESPACE      NAME                                                READY   UP-TO-DATE   AVAILABLE   AGE
apiconnect     analytics-client                                    1/1     1            1           7d16h
apiconnect     analytics-ingestion                                 1/1     1            1           7d16h
apiconnect     analytics-mtls-gw                                   1/1     1            1           7d16h
apiconnect     analytics-storage-coord                             1/1     1            1           7d16h
apiconnect     datapower-operator                                  1/1     1            1           314d
apiconnect     datapower-operator-conversion-webhook               1/1     1            1           314d
apiconnect     hostpath-provisioner                                1/1     1            1           314d
apiconnect     ibm-apiconnect                                      1/1     1            1           314d
apiconnect     management-93aee87d-postgres                        1/1     1            1           21h
apiconnect     management-93aee87d-postgres-backrest-shared-repo   1/1     1            1           21h
apiconnect     management-93aee87d-postgres-pgbouncer              1/1     1            1           21h
apiconnect     management-analytics-proxy                          1/1     1            1           5d15h
apiconnect     management-apim                                     1/1     1            1           5d15h
apiconnect     management-client-downloads-server                  1/1     1            1           5d15h
apiconnect     management-juhu                                     1/1     1            1           5d15h
apiconnect     management-ldap                                     1/1     1            1           5d15h
apiconnect     management-lur                                      1/1     1            1           5d15h
apiconnect     management-nats-operator                            1/1     1            1           5d15h
apiconnect     management-nats-streaming-operator                  1/1     1            1           5d15h
apiconnect     management-portal-proxy                             1/1     1            1           5d15h
apiconnect     management-taskmanager                              1/1     1            1           21h
apiconnect     management-ui                                       1/1     1            1           5d15h
apiconnect     management-websocket-proxy                          1/1     1            1           21h
apiconnect     postgres-operator                                   1/1     1            1           5d15h
apiconnect     tiller-deploy                                       1/1     1            1           314d
cert-manager   cert-manager                                        1/1     1            1           314d
cert-manager   cert-manager-cainjector                             1/1     1            1           314d
cert-manager   cert-manager-webhook                                1/1     1            1           314d
default        mailhog                                             1/1     1            1           7d16h
kube-system    calico-kube-controllers                             1/1     1            1           314d
kube-system    coredns                                             2/2     2            2           314d
kube-system    ingress-nginx-ingress-default-backend               1/1     1            1           314d
```

Review additional information about deployments in cert-manager namespace:
```
[root@think ~]# kubectl get deploy -n cert-manager -o wide
NAME                      READY   UP-TO-DATE   AVAILABLE   AGE    CONTAINERS     IMAGES                                             SELECTOR
cert-manager              1/1     1            1           314d   cert-manager   quay.io/jetstack/cert-manager-controller:v0.10.1   app=cert-manager,app.kubernetes.io/instance=cert-manager,app.kubernetes.io/managed-by=Tiller,app.kubernetes.io/name=cert-manager
cert-manager-cainjector   1/1     1            1           314d   cainjector     quay.io/jetstack/cert-manager-cainjector:v0.10.1   app=cainjector,app.kubernetes.io/instance=cert-manager,app.kubernetes.io/managed-by=Tiller,app.kubernetes.io/name=cainjector
cert-manager-webhook      1/1     1            1           314d   cert-manager   quay.io/jetstack/cert-manager-webhook:v0.10.1      app=webhook,app.kubernetes.io/instance=cert-manager,app.kubernetes.io/managed-by=Tiller,app.kubernetes.io/name=webhook
```

Check details of cert-manager deployment:
```
[root@think ~]# kubectl get deploy -n cert-manager cert-manager -o yaml | less
```

What is the difference between pod and deployment?

## Check statefulsets

Display information about statefulsets in the cluster:
```
[root@think ~]# kubectl get statefulset -A
NAMESPACE    NAME                       READY   AGE
apiconnect   analytics-storage-data     1/1     7d16h
apiconnect   analytics-storage-master   1/1     7d16h
apiconnect   gwv6                       1/1     7d16h
apiconnect   portal-a51ccbf8-db         1/1     23h
apiconnect   portal-a51ccbf8-www        1/1     23h
apiconnect   portal-nginx               1/1     21h
```

Review additional information about statefulsets in apiconnect namespace:
```
[root@think ~]# kubectl get statefulset -n apiconnect -o wide
NAME                       READY   AGE     CONTAINERS       IMAGES
analytics-storage-data     1/1     7d16h   storage-data     think.ibm:5443/ibm-apiconnect-analytics-analytics-storage@sha256:37243d91349ffe9bf09dd11728eac33ebb39823a44378ccb5da05634f1e64611
analytics-storage-master   1/1     7d16h   storage-master   think.ibm:5443/ibm-apiconnect-analytics-analytics-storage@sha256:37243d91349ffe9bf09dd11728eac33ebb39823a44378ccb5da05634f1e64611
gwv6                       1/1     7d16h   datapower        think.ibm:5443/ibm-apiconnect-gateway-datapower-nonprod@sha256:76f6856c5517e59717fbeac97bbae54ec9fac0fe7aa0f5c1eea52f1ac90e71ab
portal-a51ccbf8-db         1/1     23h     db,dbproxy       think.ibm:5443/ibm-apiconnect-portal-portal-db@sha256:68c5415832126f857a7c88ee81b10bc94ce903c6477f1a76b5a2076624f2411e,think.ibm:5443/ibm-apiconnect-portal-portal-dbproxy@sha256:0e3565b7665e39344c32eba47ffafa2721152b5b49853d0eb7920c74f4d010a4
portal-a51ccbf8-www        1/1     23h     admin,web        think.ibm:5443/ibm-apiconnect-portal-portal-admin@sha256:b21b6b8397713e4a28c56862ad7e97949ba3e548d6fc60be2babb6ce46033af2,think.ibm:5443/ibm-apiconnect-portal-portal-web@sha256:a8f71c4becec206f2fc9291e3e3878583c6e3a148a0ef6d9af0f1aa7b9357fe9
portal-nginx               1/1     21h     nginx            think.ibm:5443/ibm-apiconnect-portal-portal-nginx@sha256:d0f41a48c0ad8e22652b6118423388c5002aa23c2707f8ca687ab9bcd3ea0f24
```

Check details of gwv6 statefulset:
```
[root@think ~]# kubectl get statefulset -n apiconnect gwv6 -o yaml | less
```

## Check services and ingress

Display information about ingresses in apiconnect namespace:
```
[root@think ~]# kubectl get ingress -n apiconnect
Warning: extensions/v1beta1 Ingress is deprecated in v1.14+, unavailable in v1.22+; use networking.k8s.io/v1 Ingress
NAME                      CLASS    HOSTS                  ADDRESS     PORTS     AGE
analytics-ac-endpoint     <none>   ac.think.ibm           10.0.0.10   80, 443   7d16h
analytics-ai-endpoint     <none>   ai.think.ibm           10.0.0.10   80, 443   7d16h
gwv6-gateway              <none>   rgw.think.ibm          10.0.0.10   80, 443   7d16h
gwv6-gateway-manager      <none>   rgwd.think.ibm         10.0.0.10   80, 443   7d16h
management-admin          <none>   admin.think.ibm        10.0.0.10   80, 443   5d16h
management-api-manager    <none>   manager.think.ibm      10.0.0.10   80, 443   5d16h
management-consumer-api   <none>   consumer.think.ibm     10.0.0.10   80, 443   5d16h
management-platform-api   <none>   api.think.ibm          10.0.0.10   80, 443   5d16h
portal-portal-director    <none>   api.portal.think.ibm   10.0.0.10   80, 443   23h
portal-portal-web         <none>   portal.think.ibm       10.0.0.10   80, 443   23h
```

Inspect information about management-admin ingress:
```
[root@think ~]# kubectl get ingress management-admin -n apiconnect -o yaml | less
```

Find the service name and port that is receiving traffic from this ingress. Display its details:
```
[root@think ~]# kubectl get service management-juhu -n apiconnect -o yaml | less
```
What ports are exposed by this service and what port does the ingress direct the traffic to?

## Storage classes and persistent volumes.

Display storage classes that are available in the cluster:
```
[root@think ~]# kubectl get storageclass
NAME                PROVISIONER   RECLAIMPOLICY   VOLUMEBINDINGMODE   ALLOWVOLUMEEXPANSION   AGE
myblock (default)   hostpath      Delete          Immediate           false                  314d
```

Display information about persistent volumes available in the cluster:
```
[root@think ~]# kubectl get pv
NAME                                       CAPACITY   ACCESS MODES   RECLAIM POLICY   STATUS     CLAIM                                               STORAGECLASS   REASON   AGE
pvc-2927572c-e43e-4df3-85c8-e10d7cb9f596   15Gi       RWO            Retain           Bound      apiconnect/db-portal-ad7d1c8d-db-0                  myblock                 5d16h
pvc-32983450-9b02-4717-aecb-7e25b93880d4   120G       RWO            Retain           Bound      apiconnect/management-93aee87d-postgres             myblock                 5d15h
pvc-3aab94e7-1c46-415a-a4d6-9b555067f6b7   15Gi       RWO            Retain           Bound      apiconnect/db-portal-a51ccbf8-db-0                  myblock                 23h
pvc-40c5939c-06db-44f9-be14-c47ac055af3f   15Gi       RWO            Retain           Bound      apiconnect/backup-portal-a51ccbf8-www-0             myblock                 23h
pvc-491bf548-01d2-4be4-abce-b788971054d9   8Gi        RWO            Retain           Bound      apiconnect/web-portal-ad7d1c8d-www-0                myblock                 5d16h
pvc-4f9d5393-d4ff-4e76-9d0f-1cb8f1b28fc0   6Gi        RWO            Retain           Bound      apiconnect/dblogs-portal-ad7d1c8d-db-0              myblock                 5d16h
pvc-594975d1-15e7-4fb0-a65d-4fede94e413b   30G        RWO            Retain           Bound      apiconnect/management-93aee87d-postgres-wal         myblock                 5d15h
pvc-59b7b8f3-8699-4c9b-96d1-b8713734212f   6Gi        RWO            Retain           Bound      apiconnect/admin-portal-ad7d1c8d-www-0              myblock                 5d16h
pvc-6728be58-8d8f-424c-8d46-7acd2e86c000   6Gi        RWO            Retain           Bound      apiconnect/dblogs-portal-a51ccbf8-db-0              myblock                 23h
pvc-6c3b8b58-7d5e-4ff6-98f9-a2b8c043de7a   30Gi       RWO            Retain           Bound      apiconnect/gwv6-raid-volume-raid0-local-gwv6-0      myblock                 7d16h
pvc-71a5be7b-da8e-4ead-805a-2dba56e556a5   10Gi       RWO            Retain           Released   apiconnect/streaming-pvc-management-stancluster-1   myblock                 5d16h
pvc-72b42d0e-d4bb-4363-a14e-5d1f43bc93a0   6Gi        RWO            Retain           Bound      apiconnect/admin-portal-a51ccbf8-www-0              myblock                 23h
pvc-7a7860ab-ec61-4ae9-8f33-39c71e99a5f3   250Gi      RWO            Retain           Bound      apiconnect/data-analytics-storage-data-0            myblock                 7d16h
pvc-8cfcdbea-bc7c-4def-99c9-b270682924cd   120G       RWO            Retain           Bound      apiconnect/management-93aee87d-postgres-pgbr-repo   myblock                 5d16h
pvc-a32edb94-e369-45d8-9737-7fe331b9c384   15Gi       RWO            Retain           Bound      apiconnect/backup-portal-ad7d1c8d-www-0             myblock                 5d16h
pvc-b08232d5-82d9-4658-9677-a3065d304ff0   10Gi       RWO            Retain           Bound      apiconnect/streaming-pvc-management-stancluster-1   myblock                 22h
pvc-b5ecaf0c-5f3f-492f-946b-4517d99e3b17   10Gi       RWO            Retain           Bound      apiconnect/data-analytics-storage-master-0          myblock                 7d16h
pvc-b6134eb0-62c2-40b7-a11a-3220aacdcc71   1Gi        RWO            Retain           Bound      apiconnect/nginx-portal-nginx-0                     myblock                 21h
pvc-c66db85c-12ce-45d8-b5ef-41b264a2d85b   8Gi        RWO            Retain           Bound      apiconnect/web-portal-a51ccbf8-www-0                myblock                 23h
```

Display information about persistent volume claims in apiconnect namespace:
```
[root@think ~]# kubectl get pvc -n apiconnect
NAME                                     STATUS   VOLUME                                     CAPACITY   ACCESS MODES   STORAGECLASS   AGE
admin-portal-a51ccbf8-www-0              Bound    pvc-72b42d0e-d4bb-4363-a14e-5d1f43bc93a0   6Gi        RWO            myblock        23h
admin-portal-ad7d1c8d-www-0              Bound    pvc-59b7b8f3-8699-4c9b-96d1-b8713734212f   6Gi        RWO            myblock        5d16h
backup-portal-a51ccbf8-www-0             Bound    pvc-40c5939c-06db-44f9-be14-c47ac055af3f   15Gi       RWO            myblock        23h
backup-portal-ad7d1c8d-www-0             Bound    pvc-a32edb94-e369-45d8-9737-7fe331b9c384   15Gi       RWO            myblock        5d16h
data-analytics-storage-data-0            Bound    pvc-7a7860ab-ec61-4ae9-8f33-39c71e99a5f3   250Gi      RWO            myblock        7d16h
data-analytics-storage-master-0          Bound    pvc-b5ecaf0c-5f3f-492f-946b-4517d99e3b17   10Gi       RWO            myblock        7d16h
db-portal-a51ccbf8-db-0                  Bound    pvc-3aab94e7-1c46-415a-a4d6-9b555067f6b7   15Gi       RWO            myblock        23h
db-portal-ad7d1c8d-db-0                  Bound    pvc-2927572c-e43e-4df3-85c8-e10d7cb9f596   15Gi       RWO            myblock        5d16h
dblogs-portal-a51ccbf8-db-0              Bound    pvc-6728be58-8d8f-424c-8d46-7acd2e86c000   6Gi        RWO            myblock        23h
dblogs-portal-ad7d1c8d-db-0              Bound    pvc-4f9d5393-d4ff-4e76-9d0f-1cb8f1b28fc0   6Gi        RWO            myblock        5d16h
gwv6-raid-volume-raid0-local-gwv6-0      Bound    pvc-6c3b8b58-7d5e-4ff6-98f9-a2b8c043de7a   30Gi       RWO            myblock        7d16h
management-93aee87d-postgres             Bound    pvc-32983450-9b02-4717-aecb-7e25b93880d4   120G       RWO            myblock        5d15h
management-93aee87d-postgres-pgbr-repo   Bound    pvc-8cfcdbea-bc7c-4def-99c9-b270682924cd   120G       RWO            myblock        5d16h
management-93aee87d-postgres-wal         Bound    pvc-594975d1-15e7-4fb0-a65d-4fede94e413b   30G        RWO            myblock        5d15h
nginx-portal-nginx-0                     Bound    pvc-b6134eb0-62c2-40b7-a11a-3220aacdcc71   1Gi        RWO            myblock        21h
streaming-pvc-management-stancluster-1   Bound    pvc-b08232d5-82d9-4658-9677-a3065d304ff0   10Gi       RWO            myblock        22h
web-portal-a51ccbf8-www-0                Bound    pvc-c66db85c-12ce-45d8-b5ef-41b264a2d85b   8Gi        RWO            myblock        23h
web-portal-ad7d1c8d-www-0                Bound    pvc-491bf548-01d2-4be4-abce-b788971054d9   8Gi        RWO            myblock        5d16h
```

How much storage is currently allocated in your cluster?

## Check Custom Resource Definitions

Display APIs available in your cluster:
```
[root@think ~]# kubectl api-resources
NAME                              SHORTNAMES                 APIVERSION                                 NAMESPACED   KIND
bindings                                                     v1                                         true         Binding
componentstatuses                 cs                         v1                                         false        ComponentStatus
configmaps                        cm                         v1                                         true         ConfigMap
endpoints                         ep                         v1                                         true         Endpoints
events                            ev                         v1                                         true         Event
limitranges                       limits                     v1                                         true         LimitRange
namespaces                        ns                         v1                                         false        Namespace
nodes                             no                         v1                                         false        Node
persistentvolumeclaims            pvc                        v1                                         true         PersistentVolumeClaim
persistentvolumes                 pv                         v1                                         false        PersistentVolume
pods                              po                         v1                                         true         Pod
podtemplates                                                 v1                                         true         PodTemplate
replicationcontrollers            rc                         v1                                         true         ReplicationController
resourcequotas                    quota                      v1                                         true         ResourceQuota
secrets                                                      v1                                         true         Secret
serviceaccounts                   sa                         v1                                         true         ServiceAccount
services                          svc                        v1                                         true         Service
mutatingwebhookconfigurations                                admissionregistration.k8s.io/v1            false        MutatingWebhookConfiguration
validatingwebhookconfigurations                              admissionregistration.k8s.io/v1            false        ValidatingWebhookConfiguration
analyticsbackups                  a7b                        analytics.apiconnect.ibm.com/v1beta1       true         AnalyticsBackup
analyticsclusters                 a7s                        analytics.apiconnect.ibm.com/v1beta1       true         AnalyticsCluster
analyticsrestores                 a7r                        analytics.apiconnect.ibm.com/v1beta1       true         AnalyticsRestore
apiconnectclusters                apic                       apiconnect.ibm.com/v1beta1                 true         APIConnectCluster
customresourcedefinitions         crd,crds                   apiextensions.k8s.io/v1                    false        CustomResourceDefinition
apiservices                                                  apiregistration.k8s.io/v1                  false        APIService
controllerrevisions                                          apps/v1                                    true         ControllerRevision
daemonsets                        ds                         apps/v1                                    true         DaemonSet
deployments                       deploy                     apps/v1                                    true         Deployment
replicasets                       rs                         apps/v1                                    true         ReplicaSet
statefulsets                      sts                        apps/v1                                    true         StatefulSet
tokenreviews                                                 authentication.k8s.io/v1                   false        TokenReview
localsubjectaccessreviews                                    authorization.k8s.io/v1                    true         LocalSubjectAccessReview
selfsubjectaccessreviews                                     authorization.k8s.io/v1                    false        SelfSubjectAccessReview
selfsubjectrulesreviews                                      authorization.k8s.io/v1                    false        SelfSubjectRulesReview
subjectaccessreviews                                         authorization.k8s.io/v1                    false        SubjectAccessReview
horizontalpodautoscalers          hpa                        autoscaling/v1                             true         HorizontalPodAutoscaler
cronjobs                          cj                         batch/v1beta1                              true         CronJob
jobs                                                         batch/v1                                   true         Job
certificatesigningrequests        csr                        certificates.k8s.io/v1                     false        CertificateSigningRequest
certificaterequests               cr,crs                     certmanager.k8s.io/v1alpha1                true         CertificateRequest
certificates                      cert,certs                 certmanager.k8s.io/v1alpha1                true         Certificate
challenges                                                   certmanager.k8s.io/v1alpha1                true         Challenge
clusterissuers                                               certmanager.k8s.io/v1alpha1                false        ClusterIssuer
issuers                                                      certmanager.k8s.io/v1alpha1                true         Issuer
orders                                                       certmanager.k8s.io/v1alpha1                true         Order
leases                                                       coordination.k8s.io/v1                     true         Lease
bgpconfigurations                                            crd.projectcalico.org/v1                   false        BGPConfiguration
bgppeers                                                     crd.projectcalico.org/v1                   false        BGPPeer
blockaffinities                                              crd.projectcalico.org/v1                   false        BlockAffinity
clusterinformations                                          crd.projectcalico.org/v1                   false        ClusterInformation
felixconfigurations                                          crd.projectcalico.org/v1                   false        FelixConfiguration
globalnetworkpolicies                                        crd.projectcalico.org/v1                   false        GlobalNetworkPolicy
globalnetworksets                                            crd.projectcalico.org/v1                   false        GlobalNetworkSet
hostendpoints                                                crd.projectcalico.org/v1                   false        HostEndpoint
ipamblocks                                                   crd.projectcalico.org/v1                   false        IPAMBlock
ipamconfigs                                                  crd.projectcalico.org/v1                   false        IPAMConfig
ipamhandles                                                  crd.projectcalico.org/v1                   false        IPAMHandle
ippools                                                      crd.projectcalico.org/v1                   false        IPPool
kubecontrollersconfigurations                                crd.projectcalico.org/v1                   false        KubeControllersConfiguration
networkpolicies                                              crd.projectcalico.org/v1                   true         NetworkPolicy
networksets                                                  crd.projectcalico.org/v1                   true         NetworkSet
pgclusters                                                   crunchydata.com/v1                         true         Pgcluster
pgpolicies                                                   crunchydata.com/v1                         true         Pgpolicy
pgreplicas                                                   crunchydata.com/v1                         true         Pgreplica
pgtasks                                                      crunchydata.com/v1                         true         Pgtask
datapowermonitors                 dpm                        datapower.ibm.com/v1beta2                  true         DataPowerMonitor
datapowerservices                 dp                         datapower.ibm.com/v1beta2                  true         DataPowerService
endpointslices                                               discovery.k8s.io/v1beta1                   true         EndpointSlice
events                            ev                         events.k8s.io/v1                           true         Event
ingresses                         ing                        extensions/v1beta1                         true         Ingress
gatewayclusters                   gw                         gateway.apiconnect.ibm.com/v1beta1         true         GatewayCluster
managementbackups                 mgmtb                      management.apiconnect.ibm.com/v1beta1      true         ManagementBackup
managementclusters                mgmt                       management.apiconnect.ibm.com/v1beta1      true         ManagementCluster
managementdbupgrades                                         management.apiconnect.ibm.com/v1beta1      true         ManagementDBUpgrade
managementrestores                mgmtr                      management.apiconnect.ibm.com/v1beta1      true         ManagementRestore
managementsecretrotations         mgmtsr                     management.apiconnect.ibm.com/v1beta1      true         ManagementSecretRotation
natsclusters                                                 nats.apiconnect.ibm.com/v1beta1            true         NatsCluster
natsserviceroles                                             nats.apiconnect.ibm.com/v1beta1            true         NatsServiceRole
natsclusters                      nats                       nats.io/v1alpha2                           true         NatsCluster
natsserviceroles                                             nats.io/v1alpha2                           true         NatsServiceRole
natsstreamingclusters             stancluster                natsstreaming.apiconnect.ibm.com/v1beta1   true         NatsStreamingCluster
ingressclasses                                               networking.k8s.io/v1                       false        IngressClass
ingresses                         ing                        networking.k8s.io/v1                       true         Ingress
networkpolicies                   netpol                     networking.k8s.io/v1                       true         NetworkPolicy
runtimeclasses                                               node.k8s.io/v1beta1                        false        RuntimeClass
poddisruptionbudgets              pdb                        policy/v1beta1                             true         PodDisruptionBudget
podsecuritypolicies               psp                        policy/v1beta1                             false        PodSecurityPolicy
portalbackups                     pb                         portal.apiconnect.ibm.com/v1beta1          true         PortalBackup
portalclusters                    ptl                        portal.apiconnect.ibm.com/v1beta1          true         PortalCluster
portalrestores                    pr                         portal.apiconnect.ibm.com/v1beta1          true         PortalRestore
portalsecretrotations             ptlsr                      portal.apiconnect.ibm.com/v1beta1          true         PortalSecretRotation
clusterrolebindings                                          rbac.authorization.k8s.io/v1               false        ClusterRoleBinding
clusterroles                                                 rbac.authorization.k8s.io/v1               false        ClusterRole
rolebindings                                                 rbac.authorization.k8s.io/v1               true         RoleBinding
roles                                                        rbac.authorization.k8s.io/v1               true         Role
priorityclasses                   pc                         scheduling.k8s.io/v1                       false        PriorityClass
csidrivers                                                   storage.k8s.io/v1                          false        CSIDriver
csinodes                                                     storage.k8s.io/v1                          false        CSINode
storageclasses                    sc                         storage.k8s.io/v1                          false        StorageClass
volumeattachments                                            storage.k8s.io/v1                          false        VolumeAttachment
natsstreamingclusters             stanclusters,stancluster   streaming.nats.io/v1alpha1                 true         NatsStreamingCluster
mutations                                                    webhook.certmanager.k8s.io/v1beta1         false        AdmissionReview
validations                                                  webhook.certmanager.k8s.io/v1beta1         false        AdmissionReview
```

Identify which APIs are delivered by IBM as part of IBM API Connect deployment.
What are the shortnames of:
 - ManagmentCluster
 - PortalCluster
 - GatewayCluster
 - AnalyticsCluster
 - APIConnectCluster

## Operators and Custom Resources (Operands)

Operators run as deployments in apiconnect namespace. There are following operator deployments:
```
[root@think ~]# kubectl get deploy -n apiconnect | egrep 'NAME|ibm-apiconnect|datapower-operator |postgres-operator'
NAME                                                READY   UP-TO-DATE   AVAILABLE   AGE
datapower-operator                                  1/1     1            1           314d
ibm-apiconnect                                      1/1     1            1           314d
postgres-operator                                   1/1     1            1           5d16h
```

Each operator runs a loop that checks the state of operands (Custom Resources) that are being managed by it. This can be verified by reviewing logs
of the operator pod:
```
[root@think ~]# kubectl get pod -n apiconnect | grep ibm-apiconnect
ibm-apiconnect-566c6f9795-9w7kp                                   1/1     Running     0          21h
[root@think ~]# kubectl logs ibm-apiconnect-566c6f9795-9w7kp -n apiconnect | less
```

Check what API Connect operands are deployed in API Connect namespace:
```
[root@think ~]# kubectl get apic -n apiconnect
NAME                                                      READY   STATUS    VERSION                 RECONCILED VERSION      AGE
analyticscluster.analytics.apiconnect.ibm.com/analytics   8/8     Running   10.0.1.5-ifix4-57-eus   10.0.1.5-ifix4-57-eus   7d16h

NAME                                      PHASE     READY   SUMMARY                           VERSION    AGE
datapowerservice.datapower.ibm.com/gwv6   Running   True    StatefulSet replicas ready: 1/1   10.0.1.5   7d16h

NAME                                      PHASE     LAST EVENT   WORK PENDING   WORK IN-PROGRESS   AGE
datapowermonitor.datapower.ibm.com/gwv6   Running                false          false              7d16h

NAME                                             READY   STATUS    VERSION                 RECONCILED VERSION      AGE
gatewaycluster.gateway.apiconnect.ibm.com/gwv6   2/2     Running   10.0.1.5-ifix4-57-eus   10.0.1.5-ifix4-57-eus   7d16h

NAME                                                               STATUS     MESSAGE                                            BACKUP                CLUSTER      PITR   AGE
managementrestore.management.apiconnect.ibm.com/management-xgnmk   Complete   Restore process completed (DB Restore + DRR job)   management-6f13c7aa   management          5d15h

NAME                                                                 STATUS   ID                 CLUSTER      TYPE   CR TYPE   AGE
managementbackup.management.apiconnect.ibm.com/management-585b7b4d   Ready    20220316-010003F   management   full   record    30h
managementbackup.management.apiconnect.ibm.com/management-6119c9b2   Ready    20220311-135320F   management   full   record    5d16h
managementbackup.management.apiconnect.ibm.com/management-68ca85ac   Ready    20220314-010004F   management   full   record    3d6h
managementbackup.management.apiconnect.ibm.com/management-6f13c7aa   Ready    20220311-143810F   management   full   record    5d16h
managementbackup.management.apiconnect.ibm.com/management-93eab8a7   Ready    20220317-010004F   management   full   record    6h26m
managementbackup.management.apiconnect.ibm.com/management-a37b4646   Ready    20220315-010003F   management   full   record    2d6h
managementbackup.management.apiconnect.ibm.com/management-a8de2daa   Ready    20220312-010003F   management   full   record    5d6h
managementbackup.management.apiconnect.ibm.com/management-babb6c08   Ready    20220311-145609F   management   full   record    5d16h
managementbackup.management.apiconnect.ibm.com/management-fe3e3953   Ready    20220313-010003F   management   full   record    4d6h
managementbackup.management.apiconnect.ibm.com/management-tsw5z      Ready    20220316-072145F   management   full   create    24h

NAME                                                                    STATUS     MESSAGE                                                     AGE
managementdbupgrade.management.apiconnect.ibm.com/management-up-fgh5g   Complete   Upgrade is Complete (DB Schema/data are up-to-date)         22h
managementdbupgrade.management.apiconnect.ibm.com/management-up-qnf46   Complete   Fresh install is Complete (DB Schema/data are up-to-date)   5d16h

NAME                                                         READY   STATUS    VERSION                 RECONCILED VERSION      AGE
managementcluster.management.apiconnect.ibm.com/management   17/17   Running   10.0.1.5-ifix4-57-eus   10.0.1.5-ifix4-57-eus   5d16h

NAME                                             READY   STATUS    VERSION                 RECONCILED VERSION      AGE
portalcluster.portal.apiconnect.ibm.com/portal   4/4     Running   10.0.1.5-ifix4-57-eus   10.0.1.5-ifix4-57-eus   24h

NAME                                                      ID                STATUS   TYPE     CR TYPE   AGE     COMMENT
portalbackup.portal.apiconnect.ibm.com/portal-bup-6snhh   20220313.010002   Ready    system   record    23h     
portalbackup.portal.apiconnect.ibm.com/portal-bup-cnqpr   20220312.010002   Ready    system   record    23h     
portalbackup.portal.apiconnect.ibm.com/portal-bup-hfrzp                     Ready    all      create    23h     y
portalbackup.portal.apiconnect.ibm.com/portal-bup-lbddp   20220311.143744   Ready    system   record    23h     
portalbackup.portal.apiconnect.ibm.com/portal-bup-lvncp   20220316.010001   Ready    system   record    23h     
portalbackup.portal.apiconnect.ibm.com/portal-bup-mwm6c   20220311.141212   Ready    system   record    23h     
portalbackup.portal.apiconnect.ibm.com/portal-bup-smm7g   20220316.073951   Ready    system   record    23h     
portalbackup.portal.apiconnect.ibm.com/portal-bup-vdjwz   20220314.010002   Ready    system   record    23h     
portalbackup.portal.apiconnect.ibm.com/portal-bup-vwqgj   20220317.010002   Ready    system   record    6h30m   
portalbackup.portal.apiconnect.ibm.com/portal-bup-xpzhh   20220315.010002   Ready    system   record    23h     

NAME                                                           TYPE     TASK ID            STATUS   MESSAGE   AGE
portalrestore.portal.apiconnect.ibm.com/portal-restore-gqlv6   system   7fb8wtvt6uzjzijq   Ready              23h
portalrestore.portal.apiconnect.ibm.com/portal-restore-xczjj   system   smrnv5wgd7hcr7nf   Ready              23h
```

Information for each of Operand can be displayed querying it separately:
```
[root@think ~]# kubectl get -n apiconnect mgmt
NAME         READY   STATUS    VERSION                 RECONCILED VERSION      AGE
management   17/17   Running   10.0.1.5-ifix4-57-eus   10.0.1.5-ifix4-57-eus   5d16h
[root@think ~]# kubectl get -n apiconnect ptl
NAME     READY   STATUS    VERSION                 RECONCILED VERSION      AGE
portal   4/4     Running   10.0.1.5-ifix4-57-eus   10.0.1.5-ifix4-57-eus   24h
[root@think ~]# kubectl get -n apiconnect a7s
NAME        READY   STATUS    VERSION                 RECONCILED VERSION      AGE
analytics   8/8     Running   10.0.1.5-ifix4-57-eus   10.0.1.5-ifix4-57-eus   7d16h
[root@think ~]# kubectl get -n apiconnect gw
NAME   READY   STATUS    VERSION                 RECONCILED VERSION      AGE
gwv6   2/2     Running   10.0.1.5-ifix4-57-eus   10.0.1.5-ifix4-57-eus   7d16h
```

